<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Withdrawal Management Assistant</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="description" content="A clinical decision support PWA for managing alcohol and other drug withdrawal syndromes, featuring guidelines, flowcharts, and calculators.">
    <meta name="theme-color" content="#f0f0f0"/>
</head>
<body>

    <div id="app-container">
        <!-- Main Header -->
        <header class="app-header">
            <h1 id="page-title">Home</h1>
            <div class="header-controls">
                <button id="home-button">Home</button>
                <button id="theme-toggle">ðŸŒ™ Dark Mode</button>
            </div>
        </header>

        <!-- This is where the different pages will be rendered -->
        <main id="main-content">

            <!-- Home Page -->
            <div id="home-page" class="page active-page">
                <nav class="button-container">
                    <button class="big-button" data-page="alcohol-withdrawal-page">Alcohol Withdrawal Decision Flowchart</button>
                    <button class="big-button" data-page="inpatient-guidelines-page">Inpatient Alcohol Withdrawal Guidelines</button>
                    <button class="big-button" data-page="ambulatory-guidelines-page">Ambulatory (Outpatient) Detox Guidelines</button>
                    <button class="big-button" data-page="scales-page">Clinical Scales & Calculators</button>
                    <button class="big-button" data-page="other-syndromes-page">Other Withdrawal Syndromes</button>
                </nav>
            </div>

            <!-- Alcohol Withdrawal Flowchart Page -->
            <div id="alcohol-withdrawal-page" class="page">
                <!-- Content will be dynamically generated by script.js -->
            </div>

            <!-- Inpatient Guidelines Page -->
            <div id="inpatient-guidelines-page" class="page" data-title="Inpatient Alcohol Withdrawal Guidelines">
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="prerequisites">Prerequisites</button>
                        <button class="tab-button" data-tab="thiamine">Thiamine</button>
                        <button class="tab-button" data-tab="benzo-choice">1. Benzo Choice</button>
                        <button class="tab-button" data-tab="regimens">2. Regimens</button>
                        <button class="tab-button" data-tab="special-cases">Special Cases</button>
                    </div>
                    <div id="prerequisites" class="tab-content active">
                        <h3>Prerequisites</h3>
                        <p><strong>Diagnosis:</strong> Establish diagnosis of alcohol withdrawal using DSM-5 criteria. It is crucial to rule out other medical conditions that can mimic withdrawal, such as sepsis, metabolic disturbances, or intracranial events.</p>
                        <p><strong>BAL (Blood Alcohol Level):</strong> While not a contraindication to starting treatment, it is preferable to begin dosing when the BAL is low or falling (e.g., < 0.1 g/dL). This helps differentiate symptoms of intoxication from true withdrawal.</p>
                        <p><strong>Liver Function:</strong> Assess liver function (LFTs, INR, Albumin) to guide benzodiazepine choice. Severe liver impairment may necessitate using a drug with no active metabolites, like Oxazepam.</p>
                        <p><strong>CIWA-Ar Scale:</strong> Commence CIWA-Ar monitoring every 2-4 hours. This objective scale guides symptom-triggered therapy, allowing for tailored dosing and preventing both under- and over-sedation.</p>
                        <p><strong>Post-withdrawal plan:</strong> Ensure there is a follow-up plan in place for ongoing support and monitoring after the withdrawal process. To withdraw without a plan is to risk (1) relapse and broader treatment futility (2) reducing alcohol tolerance and temporarily worsening risks of intoxication.</p>
                    </div>
                    <div id="thiamine" class="tab-content">
                        <h3>Thiamine</h3>
                        <p><strong>Prophylaxis (Standard Regimen):</strong> To prevent Wernicke's Encephalopathy (WE), all patients undergoing alcohol withdrawal should receive parenteral thiamine. Commence thiamine 300mg IV/IM daily for 3-5 days. <strong>Crucially, always administer thiamine BEFORE any glucose-containing fluids.</strong></p>
                        <p><strong>Suspected Wernicke-Korsakov Syndrome (WKS):</strong> Have a high index of suspicion for WKS in any patient with confusion, ataxia, ophthalmoplegia, memory disturbance, or malnutrition. The classic triad is rare. Treatment requires high-dose thiamine: <strong>500mg IV TDS for a minimum of 5 days</strong>, followed by oral supplementation.</p>
                    </div>
                    <div id="benzo-choice" class="tab-content">
                        <h3>1. Benzodiazepine Choice</h3>
                        <p><strong>Diazepam:</strong> The standard choice due to its long half-life, which provides a smooth, self-tapering effect and reduces the risk of breakthrough symptoms and seizures.</p>
                        <p><strong>Oxazepam:</strong> Preferred in specific situations as it has no active metabolites and is less likely to accumulate.</p>
                        <p>Use <strong>Oxazepam</strong> in cases of:<br>
                             â€¢ <b>Significant liver impairment</b> (e.g., cirrhosis, high bilirubin, coagulopathy).<br>
                             â€¢ <b>Respiratory insufficiency</b> or risk of respiratory depression (e.g., COPD).<br>
                             â€¢ <b>Elderly or frail patients</b> who are more sensitive to sedative effects.<br>
                             â€¢ <b>Cerebral trauma / CVA</b> where over-sedation is a risk.</p>
                        <p><b>Conversion:</b> Diazepam 10mg is approximately equivalent to Oxazepam 30mg.</p>
                        <div class="button-group">
                            <button class="benzo-choice-btn active" data-benzo="Diazepam">Select Diazepam</button>
                            <button class="benzo-choice-btn" data-benzo="Oxazepam">Select Oxazepam</button>
                        </div>
                        <p><strong>Current Selection: <span id="benzo-selection-display">Diazepam</span></strong></p>
                    </div>
                    <div id="regimens" class="tab-content">
                        <h3>2. Regimens (CIWA-Ar)</h3>
                        <p>Displaying Regimens for: <strong id="regimen-benzo-display">Diazepam</strong></p>
                        <div class="button-group">
                            <button class="regimen-severity-btn active" data-severity="mild">Mild-Mod (indicative CIWA 10-15)</button>
                            <button class="regimen-severity-btn" data-severity="moderate">Mod-Sev (indicative CIWA 15-20)</button>
                            <button class="regimen-severity-btn" data-severity="severe">Severe (indicative CIWA > 20)</button>
                        </div>
                        <p> Ensure CIWA-Ar done q2hrly at least initially for all patients commenced on regimen. Check BAC before commencing. Do not start CIWA-Ar or benzodiazepines until 6+ hours post last drink.  Regularly review patient and adjust as per clinical judgement. </p>
                        <p> Do not give regular or PRN doses if patient is sedated. If multiple doses are not able to be given, review regular dosing schedule.</p>
                        <div id="regimen-display"></div>
                    </div>
                    <div id="special-cases" class="tab-content">
                        <h3>Special Cases</h3>
                        <p><b>Seizures (current or past):</b> Consider loading with benzodiazepines as for severe withdrawal</p>
                        <p><b>Alcohol Withdrawal Delirium:</b> Needs ICU/HDU or 1:1 nursing</p>
                        <p><b>Adjunctive Medications for Severe Symptoms:</b> In cases of delirium or severe agitation/psychosis poorly responsive to benzodiazepines, other agents may be considered <strong>after specialist consultation</strong>. Examples include low-dose antipsychotics (e.g., Haloperidol, Olanzapine). These are not first-line and require careful risk/benefit assessment.</p>
                        <p><b>General Notes:</b> If total daily diazepam equivalent exceeds 80mg, contact specialist service (e.g. D&A CL service, Drug and Alcohol State Advisory Service (DASAS) - 1800 023 687)</p>
                    </div>
                </div>
            </div>

            <!-- Ambulatory Guidelines Page -->
            <div id="ambulatory-guidelines-page" class="page" data-title="Ambulatory (Outpatient) Detox Guidelines">
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" data-tab="ambulatory-selection">1. Patient Selection</button>
                        <button class="tab-button" data-tab="ambulatory-protocol">2. Example Protocol</button>
                        <button class="tab-button" data-tab="ambulatory-meds">3. Medication Regimen</button>
                        <button class="tab-button" data-tab="ambulatory-escalation">4. When to Cease or Escalate</button>
                    </div>
                    <div id="ambulatory-selection" class="tab-content active">
                        <h3>Patient Selection Criteria</h3>
                        <p>The following criteria should be met for a patient to be considered for an outpatient (ambulatory) detox.</p>
                        <h4>Inclusion Criteria</h4>
                        <ul>
                            <li>Age &gt; 18-years-old.</li>
                            <li>Has undertaken a comprehensive AOD assessment.</li>
                            <li>Patient has up-to-date FBC, LFTs, EUCs, INR, and these have been reviewed by the AOD clinician.</li>
                            <li>Patient is diagnosed with an alcohol use disorder.</li>
                            <li>Mild to moderate alcohol withdrawal severity expected, defined by:
                                <ul>
                                    <li>Average or low risk on Prediction of Alcohol Withdrawal Severity Scale (PAWSS), OR a clear clinical rationale exists for proceeding despite a higher score.</li>
                                    <li>Patientâ€™s average alcohol intake is â‰¤15 standard drinks per day.</li>
                                </ul>
                            </li>
                            <li>Patient agrees to daily review at the service.</li>
                            <li>Patient has nominated a pharmacy or other suitable location (e.g. clinic or practice where medicines have been left) for DAILY pickup of medication, and the dispensing location has agreed.</li>
                            <li>Patient has a reasonably safe home environment or supervision.</li>
                            <li>Patient has reliable means for daily reviews (e.g., transport to review or clinician will go to patient).</li>
                            <li>Patient has a reasonable plan for service engagement after detox (e.g., outpatient services, rehabilitation).</li>
                            <li>There is no alcohol remaining in the house prior to detox commencing.</li>
                        </ul>
                        <h4>Exclusion Criteria (Contraindications)</h4>
                        <ul>
                            <li>Medical or psychiatric contraindications, including but not limited to: a seizure disorder, prior or current Wernicke-Korsakoff syndrome, history of suicide attempts, cognitive impairment, or recurrent delirium.</li>
                            <li>Major unmanaged hepatic or renal disease. If present, discussion with an addiction medicine specialist is required regarding regimen modification (e.g., using oxazepam instead of diazepam).</li>
                            <li>Patient is on regular opioids, beta-blockers, or alpha-adrenergic acting agents (e.g., clonidine, prazosin) due to potential interactions and/or masking of alcohol withdrawal symptoms.</li>
                        </ul>
                    </div>
                    <div id="ambulatory-protocol" class="tab-content">
                        <h3>Example Daily Protocol</h3>
                        <p>This is an example process for a structured outpatient detox program.</p>
                        <ul>
                            <li>All detoxes start on Monday, cease on Friday, and are organised the week prior.</li>
                            <li>Scripts for the weaning regimen are written by the patient's GP or a service medical officer.</li>
                            <li><b>Patient must present daily for review:</b>
                                <ul>
                                    <li>Nursing staff perform a CIWA-Ar assessment in the AM before the first dose of the day.</li>
                                    <li>Nursing staff perform a brief delirium screen daily (e.g., 4AT screen).</li>
                                    <li>Nursing staff perform a breathalyser test. <b>All patients must have an undetectable BAL to qualify for further benzodiazepines.</b></li>
                                    <li>Basic observations are taken (HR, BP, RR, temperature).</li>
                                    <li>If all checks are satisfactory, staff will call the nominated pharmacy to authorise the dispensing of the next day's supply of medication.</li>
                                </ul>
                            </li>
                            <li><b>Medical Officer Review Triggers:</b>
                                <ul>
                                    <li>Nursing staff should call the AOD medical officer if CIWA-Ar score is &gt;20 or other complications arise.</li>
                                    <li>The medical officer should consider calling a specialist service (e.g., DASAS 1800 023 687) if withdrawal appears severe despite treatment.</li>
                                    <li>Top-up doses may be considered in rare circumstances via a separate, specific script.</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    <div id="ambulatory-meds" class="tab-content">
                        <h3>Medication Regimen</h3>
                        <p><strong>Example Diazepam Regimen (Fixed-Dose):</strong></p>
                        <p>A common approach is a 5-day fixed-dose weaning regimen. This must be adjusted based on clinical assessment. <strong>Staged, daily supply from a pharmacy is essential.</strong></p>
                        <ul>
                             <li><b>Day 1:</b> 10mg QID (four times a day)</li>
                             <li><b>Day 2:</b> 10mg TDS (three times a day)</li>
                             <li><b>Day 3:</b> 10mg BD (twice a day)</li>
                             <li><b>Day 4:</b> 5mg BD (twice a day)</li>
                             <li><b>Day 5:</b> 5mg Nocte (at night), then cease.</li>
                        </ul>
                        <p><strong>Dosing Times:</strong></p>
                        <p>A QID (four times a day) schedule can be challenging. While ideal times might be 0600, 1200, 1800, 2200, a more realistic schedule based on service opening hours might be:</p>
                        <p><strong>09:00, 13:00, 18:00, 22:00</strong></p>
                        <p>It is helpful to provide the patient with a pictorial or clearly written schedule of their dosing times.</p>
                    </div>
                    <div id="ambulatory-escalation" class="tab-content">
                        <h3>When to Cease or Escalate Care</h3>
                        <h4>Situations Triggering Protocol to be Aborted</h4>
                        <ul>
                            <li>Patient has a positive BAL (Blood Alcohol Level).</li>
                            <li>Patient does not present for reviews or is not taking diazepam as directed (e.g., taking takeaway doses all at once).</li>
                            <li>Use of other interacting substances (e.g., opioids, illicit drugs).</li>
                            <li>Verbal abuse or violence towards staff.</li>
                            <li>Oversedation despite the clinician decreasing doses.</li>
                        </ul>
                        <h4>Situations Triggering Presentation to Hospital</h4>
                        <ul>
                            <li>Seizures</li>
                            <li>Delirium</li>
                            <li>Hallucinations</li>
                            <li>Suicidality</li>
                            <li>Other acute medical concerns</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Scales & Calculators Page -->
<div id="scales-page" class="page" data-title="Clinical Scales & Calculators">
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-button active" data-tab="std-drinks">Standard Drinks</button>
            <button class="tab-button" data-tab="aws">AWS</button>
            <button class="tab-button" data-tab="ciwa-ar">CIWA-Ar</button>
            <button class="tab-button" data-tab="saws">SAWS</button>
            <button class="tab-button" data-tab="cows">COWS (Opiate)</button>
            <button class="tab-button" data-tab="ciwa-b">CIWA-B (Benzo)</button>
            <button class="tab-button" data-tab="nsw-cws">Cannabis WS</button>
            <button class="tab-button" data-tab="cwas">CWAS</button>
        </div>

        <!-- This is a hidden template for generating calculators -->
        <div id="calculator-template" style="display: none;">
            <h3 class="calculator-title"></h3>
            <p class="calculator-note" style="display: none;"></p>
            <div class="calculator-items">
                <!-- Items will be injected here by JS -->
            </div>
            <div class="results-grid">
                <label>Total Score:</label><span class="total-score">0</span>
                <label>Severity:</label><span class="severity"></span>
            </div>
            <textarea class="emr-summary" readonly></textarea>
            <div class="button-group">
                <button class="copy-btn">Copy EMR Summary</button>
                <button class="reset-btn">Reset</button>
            </div>
        </div>
        
        <section id="std-drinks" class="tab-content active">
            <div class="tab-container">
                <div class="tab-buttons">
                    <button class="tab-button active" data-tab="std-by-type">Calculate by Common Drink Types</button>
                    <button class="tab-button" data-tab="std-by-volume">Calculate by Custom Volume & ABV</button>
                </div>
                <div id="std-by-type" class="tab-content">
                    <div class="form-grid std-drinks-grid">
                        <fieldset>
                            <legend>Beer</legend>
                            <label for="b1">Full Strength (4.8%) - Schooner (285ml)</label><input type="number" id="b1" data-sd="1.1" placeholder="Qty">
                            <label for="b2">Full Strength (4.8%) - Pint (425ml)</label><input type="number" id="b2" data-sd="1.6" placeholder="Qty">
                            <label for="b3">Full Strength (4.8%) - Can/Stubby (375ml)</label><input type="number" id="b3" data-sd="1.4" placeholder="Qty">
                            <label for="b4">Mid Strength (3.5%) - Schooner (285ml)</label><input type="number" id="b4" data-sd="0.8" placeholder="Qty">
                            <label for="b5">Mid Strength (3.5%) - Pint (425ml)</label><input type="number" id="b5" data-sd="1.2" placeholder="Qty">
                            <label for="b6">Mid Strength (3.5%) - Can/Stubby (375ml)</label><input type="number" id="b6" data-sd="1.0" placeholder="Qty">
                            <label for="b7">Low Strength (2.7%) - Schooner (285ml)</label><input type="number" id="b7" data-sd="0.6" placeholder="Qty">
                            <label for="b8">Low Strength (2.7%) - Pint (425ml)</label><input type="number" id="b8" data-sd="0.9" placeholder="Qty">
                            <label for="b9">Low Strength (2.7%) - Can/Stubby (375ml)</label><input type="number" id="b9" data-sd="0.8" placeholder="Qty">
                        </fieldset>
                        <fieldset>
                            <legend>Wine & Champagne</legend>
                            <label for="w1">Red Wine (13.5%) - Restaurant Serve (150ml)</label><input type="number" id="w1" data-sd="1.6" placeholder="Qty">
                            <label for="w2">Red Wine (13.5%) - Standard Serve (100ml)</label><input type="number" id="w2" data-sd="1.0" placeholder="Qty">
                            <label for="w3">Red Wine (13.5%) - Bottle (750ml)</label><input type="number" id="w3" data-sd="8.0" placeholder="Qty">
                            <label for="w4">White Wine (12.5%) - Restaurant Serve (150ml)</label><input type="number" id="w4" data-sd="1.4" placeholder="Qty">
                            <label for="w5">White Wine (12.5%) - Standard Serve (100ml)</label><input type="number" id="w5" data-sd="1.0" placeholder="Qty">
                            <label for="w6">White Wine (12.5%) - Bottle (750ml)</label><input type="number" id="w6" data-sd="7.5" placeholder="Qty">
                            <label for="w7">Champagne (12.5%) - Flute (150ml)</label><input type="number" id="w7" data-sd="1.5" placeholder="Qty">
                        </fieldset>
                        <fieldset>
                            <legend>Casks & Fortified Wine</legend>
                            <label for="c1">Red Wine Cask (13.5%) - 2L</label><input type="number" id="c1" data-sd="21.0" placeholder="Qty">
                            <label for="c2">Red Wine Cask (13.5%) - 4L</label><input type="number" id="c2" data-sd="43.0" placeholder="Qty">
                            <label for="c3">White Wine Cask (12.5%) - 2L</label><input type="number" id="c3" data-sd="19.5" placeholder="Qty">
                            <label for="c4">White Wine Cask (12.5%) - 4L</label><input type="number" id="c4" data-sd="39.0" placeholder="Qty">
                            <label for="c5">Port (17.5%) - Serve (60ml)</label><input type="number" id="c5" data-sd="0.8" placeholder="Qty">
                        </fieldset>
                        <fieldset>
                            <legend>Spirits & Pre-mix (RTDs)</legend>
                            <label for="s1">Spirit Nip (40%) - 30ml</label><input type="number" id="s1" data-sd="1.0" placeholder="Qty">
                            <label for="s2">Spirit Bottle (40%) - 700ml</label><input type="number" id="s2" data-sd="22.0" placeholder="Qty">
                            <label for="s3">Spirit Bottle (40%) - 1L</label><input type="number" id="s3" data-sd="31.6" placeholder="Qty">
                            <label for="s4">RTD Full Strength (5%) - 275ml</label><input type="number" id="s4" data-sd="1.1" placeholder="Qty">
                            <label for="s5">RTD Full Strength (5%) - 375ml</label><input type="number" id="s5" data-sd="1.5" placeholder="Qty">
                            <label for="s6">RTD High Strength (7%) - 375ml</label><input type="number" id="s6" data-sd="2.1" placeholder="Qty">
                        </fieldset>
                    </div>
                    <div class="button-group">
                        <button id="calculate-by-type">Calculate</button>
                        <button class="reset-btn">Reset</button>
                    </div>
                    <textarea id="type-result" readonly></textarea>
                </div>
                <div id="std-by-volume" class="tab-content">
                    <h3>Calculate by Volume and ABV</h3>
                    <div class="form-grid">
                        <label for="volume-ml">Volume of beverage (mL):</label>
                        <input type="number" id="volume-ml" placeholder="e.g., 375">
                        <label for="abv-percent">Alcohol by Volume (ABV %):</label>
                        <input type="number" id="abv-percent" placeholder="e.g., 4.8">
                    </div>
                    <div class="button-group">
                        <button id="calculate-by-volume">Calculate</button>
                        <button class="reset-btn">Reset</button>
                    </div>
                    <textarea id="volume-result" readonly></textarea>
                </div>
            </div>
        </section>
        
        <section id="aws" class="tab-content calculator-container">
    <!-- Content will be generated by script.js -->
</section>

<section id="ciwa-ar" class="tab-content calculator-container">
    <!-- Content will be generated by script.js -->
</section>

<section id="saws" class="tab-content calculator-container">
    <!-- Content will be generated by script.js -->
</section>

<section id="cows" class="tab-content calculator-container">
    <!-- Content will be generated by script.js -->
</section>
        <section id="ciwa-b" class="tab-content calculator-container">
            <!-- Content will be generated by script.js -->
        </section>
        <section id="nsw-cws" class="tab-content calculator-container">
            <!-- Content will be generated by script.js -->
        </section>
        <section id="cwas" class="tab-content calculator-container">
            <!-- Content will be generated by script.js -->
        </section>
    </div>
</div>

<!-- Other Syndromes Page -->
<div id="other-syndromes-page" class="page" data-title="Other Withdrawal Syndromes">
    <div class="button-container">
        <button class="big-button" data-link-to-scale="cows">Opioid Withdrawal (COWS)</button>
        <button class="big-button" data-link-to-scale="ciwa-b">Benzodiazepine Withdrawal (CIWA-B)</button>
        <button class="big-button" data-link-to-scale="nsw-cws">Cannabis Withdrawal Checklist</button>
    </div>
</div>

        </main>

        <!-- Footer / Status Bar -->
        <footer class="app-footer">
            <div style="display: flex; justify-content: space-between; width: 100%; font-size: 12px;">
                <span>Version 0.1.2</span>
                <span>Information contained herein is not a substitute for professional medical advice. We recommend seeking assistance from D&A, consultation-liaison addiction, DASAS or similar services for this.</span>
            </div>
        </footer>

    </div>

    <script src="script.js"></script>
</body>
</html>